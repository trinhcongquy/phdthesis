\begin{tikzpicture}[show background rectangle]
    \begin{scope}
    \matrix (m) [context-matrix,nodes={state,state-n},nodes in empty cells] {
      |[path fading=west]| & & & & & & & & & & |[path fading=east]| \\
    };

    %% ---------------------------------------------

    \matrix (m2) [context-matrix] at (0,-1.25) { % at (-0.5,-2) {
      |[context,path fading=west]| & |[state,state-n]| & |[context]| & |[state,state-n]| & |[context,path fading=east]| \\
    };

    %% ---------------------------------------------

    
    \begin{pgfonlayer}{my background}
      % \fill[fill=blue!20,path fading=north]
      \path[shading=axis,top color=gray!10,bottom color=blue!20]
      (m2-1-3.north west) .. controls +(up:7mm) and +(down:6mm) .. (m-1-3.south west) --
      (m-1-7.south east) .. controls +(down:6mm) and +(up:7mm) .. (m2-1-3.north east) -- cycle;
    \end{pgfonlayer}

    \draw[project,<->,shorten >=2pt,shorten <=2pt] (m2-1-2) .. controls +(up:7mm) and +(down:7mm) .. (m-1-2);
    \draw[project,<->,shorten >=2pt,shorten <=2pt] (m2-1-4) .. controls +(up:7mm) and +(down:7mm) .. (m-1-8);

    \node[above=0pt of m-1-2,anchor=south,scale=0.5]{${h(i)}$};
    \node[above=0pt of m-1-8,anchor=south,scale=0.5]{${h(i+1)}$};
    \node[below=0pt of m2-1-2,anchor=north,scale=0.5]{${i}$};
    \node[below=0pt of m2-1-4,anchor=north,scale=0.5]{${i+1}$};

    %\node[na-looplabel] at ([shift={(0,-0.5)}]bg.south) {Projection};
  \end{scope}

\end{tikzpicture}
